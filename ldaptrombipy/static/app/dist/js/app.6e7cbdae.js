(function(){"use strict";var e={198:function(e,t,r){var s=r(963),n=r(252);function i(e,t,r,s,i,o){const a=(0,n.up)("TrombiCal");return(0,n.wg)(),(0,n.j4)(a,{msg:"Welcome to Your Vue.js App"})}var o=r(577),a=r.p+"img/logo.ecdffaac.png",l=r.p+"img/no-photo.8b8b55cd.jpg";const c={id:"wrapper"},u={id:"sidebar-wrapper"},d={class:"logo-container"},h={class:"sidebar-nav"},p={key:0},g=["onClick"],f=["onClick"],m={id:"page-content-wrapper"},v={class:"container-fluid"},w={key:0},b={class:"card mb-3"},_={class:"row g-0"},U={class:"col-md-3"},y=["src"],P={key:1,src:l,class:"img-fluid rounded-start",alt:"Pensez à ajouter une photo"},k={class:"col-md-9 no-padding"},D={key:1},C={key:0},A={class:"row"},M={class:"card align",style:{width:"18rem"}},O=["src"],$={key:1,width:"250",src:l,class:"card-img-top",alt:"..."};function z(e,t,r,i,l,z){const x=(0,n.up)("UserCard"),E=(0,n.up)("UserCalendar");return(0,n.wg)(),(0,n.iD)("div",c,[(0,n._)("div",u,[(0,n._)("div",d,[(0,n._)("img",{onClick:t[0]||(t[0]=t=>e.refresh()),id:"logo",src:a})]),(0,n._)("h1",{id:"refresh",onClick:t[1]||(t[1]=t=>e.refresh())},(0,o.zw)(e.$config.APP_NAME),1),(0,n._)("ul",h,[(0,n.wy)((0,n._)("input",{class:"form form-control",placeholder:"Rechercher",type:"text",name:"search",id:"search","onUpdate:modelValue":t[2]||(t[2]=t=>e.searchPattern=t),onInput:t[3]||(t[3]=(...t)=>e.filterUsers&&e.filterUsers(...t))},null,544),[[s.nr,e.searchPattern]]),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.filteredUsers,((t,r)=>((0,n.wg)(),(0,n.iD)("li",{key:t},[t.length>0?((0,n.wg)(),(0,n.iD)("div",p,[(0,n._)("a",{class:"dep",href:"#",onClick:t=>e.setCurrDepartment(r)},(0,o.zw)(r),9,g),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t,(t=>((0,n.wg)(),(0,n.iD)("a",{class:"person",key:t,onClick:r=>e.setCurrentUser(t)},(0,o.zw)(t.displayName),9,f)))),128))])):(0,n.kq)("",!0)])))),128))])]),(0,n._)("div",m,[(0,n._)("div",v,[e.currentUser?((0,n.wg)(),(0,n.iD)("div",w,[(0,n._)("div",b,[(0,n._)("div",_,[(0,n._)("div",U,[e.currentUser.has_photo?((0,n.wg)(),(0,n.iD)("img",{key:0,src:`${e.$config.API_ENDPOINT}/static/images/${e.currentUser?.sAMAccountName}.${e.currentUser?.photo_extension}`,class:"img-fluid rounded-start"},null,8,y)):((0,n.wg)(),(0,n.iD)("img",P))]),(0,n._)("div",k,[(0,n.Wm)(x,{user:e.currentUser,onHasPhoto:t[4]||(t[4]=t=>e.changeHasPhotoProp(t)),displayAddPhoto:""},null,8,["user"])])])]),(0,n._)("div",null,[(0,n.Wm)(E,{user:e.currentUser},null,8,["user"])])])):((0,n.wg)(),(0,n.iD)("div",D,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.filteredUsers,((r,s)=>((0,n.wg)(),(0,n.iD)("div",{key:r},[r.length>0?((0,n.wg)(),(0,n.iD)("div",C,[(0,n._)("h3",null,(0,o.zw)(s),1),(0,n._)("div",A,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r,(r=>((0,n.wg)(),(0,n.iD)("div",{class:"card-container",key:r},[(0,n._)("div",M,[r.has_photo?((0,n.wg)(),(0,n.iD)("img",{key:0,src:`${e.$config.API_ENDPOINT}/static/images/${r?.sAMAccountName}.${r?.photo_extension}`,class:"card-img-top"},null,8,O)):((0,n.wg)(),(0,n.iD)("img",$)),(0,n.Wm)(x,{user:r,onSetUser:t[5]||(t[5]=t=>e.setCurrentUser(t)),displaySeeMoreBtn:""},null,8,["user"])])])))),128))])])):(0,n.kq)("",!0)])))),128))]))])])])}var x=r(669),E=r.n(x);const N={class:"card-body no-padding-top"},j={key:0},I=(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",fill:"currentColor",class:"bi bi-person",viewBox:"0 0 16 16"},[(0,n._)("path",{d:"M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"})],-1),H={key:1},L=(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",fill:"currentColor",class:"bi bi-telephone",viewBox:"0 0 16 16"},[(0,n._)("path",{d:"M3.654 1.328a.678.678 0 0 0-1.015-.063L1.605 2.3c-.483.484-.661 1.169-.45 1.77a17.568 17.568 0 0 0 4.168 6.608 17.569 17.569 0 0 0 6.608 4.168c.601.211 1.286.033 1.77-.45l1.034-1.034a.678.678 0 0 0-.063-1.015l-2.307-1.794a.678.678 0 0 0-.58-.122l-2.19.547a1.745 1.745 0 0 1-1.657-.459L5.482 8.062a1.745 1.745 0 0 1-.46-1.657l.548-2.19a.678.678 0 0 0-.122-.58L3.654 1.328zM1.884.511a1.745 1.745 0 0 1 2.612.163L6.29 2.98c.329.423.445.974.315 1.494l-.547 2.19a.678.678 0 0 0 .178.643l2.457 2.457a.678.678 0 0 0 .644.178l2.189-.547a1.745 1.745 0 0 1 1.494.315l2.306 1.794c.829.645.905 1.87.163 2.611l-1.034 1.034c-.74.74-1.846 1.065-2.877.702a18.634 18.634 0 0 1-7.01-4.42 18.634 18.634 0 0 1-4.42-7.009c-.362-1.03-.037-2.137.703-2.877L1.885.511z"})],-1),T={key:2},B=(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",fill:"currentColor",class:"bi bi-phone",viewBox:"0 0 16 16"},[(0,n._)("path",{d:"M11 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h6zM5 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H5z"}),(0,n._)("path",{d:"M8 14a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"})],-1),Z=["href"],q=(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-envelope",viewBox:"0 0 16 16"},[(0,n._)("path",{d:"M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2zm13 2.383-4.758 2.855L15 11.114v-5.73zm-.034 6.878L9.271 8.82 8 9.583 6.728 8.82l-5.694 3.44A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.739zM1 11.114l4.758-2.876L1 5.383v5.73z"})],-1),S=[q],F={key:4},V=(0,n._)("br",null,null,-1),W={key:0,class:"custom-file"},Y=(0,n._)("label",{class:"custom-file-label",for:"customFile"},"Ajouter ou modifier la photo",-1);function G(e,t,r,s,i,a){return(0,n.wg)(),(0,n.iD)("div",N,[(0,n._)("h5",{class:"card-title",style:{cursor:"pointer"},onClick:t[0]||(t[0]=e=>a.changeUser(r.user))},(0,o.zw)(r.user?.displayName),1),r.user?.description?.length>0?((0,n.wg)(),(0,n.iD)("div",j,[I,(0,n.Uk)(" "+(0,o.zw)(r.user?.description[0]),1)])):(0,n.kq)("",!0),r.user?.homePhone&&r.user?.homePhone?.length>0?((0,n.wg)(),(0,n.iD)("div",H,[L,(0,n.Uk)(" "+(0,o.zw)(r.user?.homePhone),1)])):(0,n.kq)("",!0),r.user?.mobile&&r.user?.mobile?.length>0?((0,n.wg)(),(0,n.iD)("div",T,[B,(0,n.Uk)(" "+(0,o.zw)(r.user?.mobile),1)])):(0,n.kq)("",!0),(0,n._)("a",{href:"mailto: "+r.user?.mail,class:"btn btn-primary",title:"Envoyer un email"},S,8,Z),r.displaySeeMoreBtn?((0,n.wg)(),(0,n.iD)("button",{key:3,title:"Aller à la fiche",onClick:t[1]||(t[1]=e=>a.changeUser(r.user)),class:"btn btn-primary ml-3"}," Détail ")):(0,n.kq)("",!0),r.displayAddPhoto?((0,n.wg)(),(0,n.iD)("div",F,[V,e.$config.SELF_UPLOAD_PHOTO?((0,n.wg)(),(0,n.iD)("div",W,[(0,n._)("input",{onChange:t[2]||(t[2]=(...e)=>a.uploadImg&&a.uploadImg(...e)),type:"file",class:"custom-file-input",id:"customFile"},null,32),Y])):(0,n.kq)("",!0)])):(0,n.kq)("",!0)])}r(718);var K={name:"user-card",props:{user:Object,displaySeeMoreBtn:Boolean,displayAddPhoto:Boolean},data(){return{photoPath:null,has_photo:!1}},methods:{changeUser(e){this.$emit("setUser",e)},uploadImg(e){if(this.photoPath=e.target.files[0],this.photoPath){let e=new FormData;e.append("image",this.photoPath),E().post(`${this.$config.API_ENDPOINT}/upload_photo/${this.user.sAMAccountName}`,e).then((e=>{this.imagePath=e.data.path,this.$emit("hasPhoto",this.user.sAMAccountName)}))}}}},R=r(744);const J=(0,R.Z)(K,[["render",G]]);var Q=J;const X=(0,n._)("div",{id:"calendar"},null,-1),ee=[X];function te(e,t,r,s,i,o){return(0,n.wg)(),(0,n.iD)("div",null,ee)}var re=r(636),se=r(374),ne=r(369),ie=r(176),oe=r(993),ae=r(897),le=r(29),ce=r(292),ue={name:"user-calendar",props:{user:Object},watch:{user:function(){this.setUpCalendar()}},data(){return{calendar:null,nextButton:null,previousButton:null}},mounted(){this.setUpCalendar(this.user)},methods:{setUpCalendar(){let e=document.getElementById("calendar");this.calendar=new re.f(e,{locale:se.Z,plugins:[oe.Z,le.Z,ae.ZP,ie.Z,ce.Z],initialView:"timeGridWeek",events:{url:`${this.$config.API_ENDPOINT}/caldav/${this.user.mail}`},eventSourceFailure(e){alert("Error lors du chargement de l'agenda... Appelez un geek")},slotMinTime:"06:00:00",slotMaxTime:"20:00:00",height:600,editable:!0,selectable:!0,headerToolbar:{left:"dayGridMonth,timeGridWeek,timeGridDay,listWeek",center:"title",right:"prev,next"},datesSet:this.dateChange,eventMouseEnter:this.handleMouseEnter,eventDidMount:this.handlEventDidMount}),this.calendar.render()},handleMouseEnter(e){console.log(e.event),console.log(e.event.extendedProps)},handlEventDidMount(e){const t=`\n                <b> ${e.event.title} </b> <br/>\n                <p>\n                    <b> Organisateur </b> ${e.event.extendedProps.organizer} </br>\n                     <b> Début </b> : ${e.event.extendedProps.begin_str}  </br>\n                    <b> Fin </b> : ${e.event.extendedProps.end_str} </br>\n                    <b> Lieu </b>: ${e.event.extendedProps.location}\n                </p>\n                <b> Participants </b>: ${e.event.extendedProps.attendees}\n            `;console.log(e.event),(0,ne.ZP)(e.el,{content:t,allowHTML:!0})}}};const de=(0,R.Z)(ue,[["render",te]]);var he=de,pe={name:"trombi-cal",props:{msg:String},components:{UserCard:Q,UserCalendar:he},mounted(){document.title=this.$config.APP_NAME,E().get(`${this.$config.API_ENDPOINT}/users_order_by_dep`).then((e=>{this.allUsers=e.data,this.filteredUsers=Object.assign(this.allUsers,{})}))},data(){return{departments:{},currentUser:null,allUsers:{},filteredUsers:{},searchPattern:null}},methods:{setCurrentUser(e){this.currentUser=e},setCurrDepartment(e){this.currentUser=null,this.curDepartment=e,this.filteredUsers={},Object.keys(this.allUsers).map((t=>{e==t&&(this.filteredUsers[e]=this.allUsers[e])}))},refresh(){this.filteredUsers=this.allUsers,this.currentUser=null},changeHasPhotoProp(e){Object.keys(this.allUsers).forEach((t=>{this.allUsers[t].forEach((t=>{e==t.sAMAccountName&&(t.has_photo&&alert("Rechargez la page pour voir la nouvelle photo"),t.has_photo=!0)}))}))},filterUsers(){this.filteredUsers=Object.assign({},this.allUsers),0===this.searchPattern.length?this.filteredUsers=this.allUsers:Object.keys(this.filteredUsers).forEach((e=>{this.filteredUsers[e]=this.allUsers[e].filter((e=>-1!==e.displayName.toLowerCase().indexOf(this.searchPattern.toLowerCase())))}))}}};const ge=(0,R.Z)(pe,[["render",z],["__scopeId","data-v-5692fbcd"]]);var fe=ge,me={name:"App",components:{TrombiCal:fe}};const ve=(0,R.Z)(me,[["render",i]]);var we=ve;E().get("./config.json").then((e=>{const t=(0,s.ri)(we);t.config.globalProperties.$config=e.data,t.mount("#app")}))}},t={};function r(s){var n=t[s];if(void 0!==n)return n.exports;var i=t[s]={exports:{}};return e[s](i,i.exports,r),i.exports}r.m=e,function(){var e=[];r.O=function(t,s,n,i){if(!s){var o=1/0;for(u=0;u<e.length;u++){s=e[u][0],n=e[u][1],i=e[u][2];for(var a=!0,l=0;l<s.length;l++)(!1&i||o>=i)&&Object.keys(r.O).every((function(e){return r.O[e](s[l])}))?s.splice(l--,1):(a=!1,i<o&&(o=i));if(a){e.splice(u--,1);var c=n();void 0!==c&&(t=c)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[s,n,i]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){r.p=""}(),function(){var e={143:0};r.O.j=function(t){return 0===e[t]};var t=function(t,s){var n,i,o=s[0],a=s[1],l=s[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(n in a)r.o(a,n)&&(r.m[n]=a[n]);if(l)var u=l(r)}for(t&&t(s);c<o.length;c++)i=o[c],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return r.O(u)},s=self["webpackChunktrombi_cal"]=self["webpackChunktrombi_cal"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=r.O(void 0,[998],(function(){return r(198)}));s=r.O(s)})();
//# sourceMappingURL=app.6e7cbdae.js.map